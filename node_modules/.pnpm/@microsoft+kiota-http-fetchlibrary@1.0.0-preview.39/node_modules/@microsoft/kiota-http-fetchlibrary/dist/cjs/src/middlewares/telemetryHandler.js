"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TelemetryHandler = exports.TelemetryHandlerOptionsKey = void 0;
exports.TelemetryHandlerOptionsKey = "TelemetryHandlerOptionsKey";
class TelemetryHandler {
    constructor(telemetryHandlerOptions) {
        this.telemetryHandlerOptions = telemetryHandlerOptions;
    }
    execute(url, requestInit, requestOptions) {
        if (this.telemetryHandlerOptions && this.telemetryHandlerOptions.telemetryConfigurator) {
            this.telemetryHandlerOptions.telemetryConfigurator(url, requestInit, requestOptions, this.telemetryHandlerOptions.telemetryInformation);
        }
        else if (requestOptions && requestOptions[exports.TelemetryHandlerOptionsKey]) {
            requestOptions[exports.TelemetryHandlerOptionsKey].telemetryConfigurator(url, requestInit, requestOptions);
        }
        if (!this.next) {
            throw new Error("Please set the next middleware to continue the request");
        }
        return this.next.execute(url, requestInit, requestOptions);
    }
}
exports.TelemetryHandler = TelemetryHandler;
