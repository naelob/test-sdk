"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isLocalhostUrl = exports.validateProtocol = void 0;
const localhostStrings = new Set(["localhost", "[::1]", "::1", "127.0.0.1"]);
function validateProtocol(url) {
    if (!isLocalhostUrl(url) && !url.toLocaleLowerCase().startsWith("https://") && !windowUrlStartsWithHttps()) {
        throw new Error("Authentication scheme can only be used with https requests");
    }
}
exports.validateProtocol = validateProtocol;
function windowUrlStartsWithHttps() {
    // @ts-ignore
    return typeof window !== "undefined" && typeof window.location !== "undefined" && window.location.protocol.toLowerCase() !== "https:";
}
function isLocalhostUrl(urlString) {
    try {
        const url = new URL(urlString);
        return localhostStrings.has(url.hostname);
    }
    catch (e) {
        return false;
    }
}
exports.isLocalhostUrl = isLocalhostUrl;
//# sourceMappingURL=validateProtocol.js.map