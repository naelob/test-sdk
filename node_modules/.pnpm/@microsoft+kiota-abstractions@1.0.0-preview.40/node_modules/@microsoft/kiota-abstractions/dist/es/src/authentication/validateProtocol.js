const localhostStrings = new Set(["localhost", "[::1]", "::1", "127.0.0.1"]);
export function validateProtocol(url) {
    if (!isLocalhostUrl(url) && !url.toLocaleLowerCase().startsWith("https://") && !windowUrlStartsWithHttps()) {
        throw new Error("Authentication scheme can only be used with https requests");
    }
}
function windowUrlStartsWithHttps() {
    // @ts-ignore
    return typeof window !== "undefined" && typeof window.location !== "undefined" && window.location.protocol.toLowerCase() !== "https:";
}
export function isLocalhostUrl(urlString) {
    try {
        const url = new URL(urlString);
        return localhostStrings.has(url.hostname);
    }
    catch (e) {
        return false;
    }
}
//# sourceMappingURL=validateProtocol.js.map